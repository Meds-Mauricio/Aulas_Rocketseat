"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:true});exports.getQueryContextData=getQueryContextData;exports.QueryContextData=void 0;var _regenerator=_interopRequireDefault(require("@babel/runtime/regenerator"));var _asyncToGenerator2=_interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));var _classCallCheck2=_interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));var _createClass2=_interopRequireDefault(require("@babel/runtime/helpers/createClass"));if(!global.dictQueryContextData)global.dictQueryContextData={};function getQueryContextData(contextApiUrl){var dict=global.dictQueryContextData;var qd=dict[contextApiUrl];if(qd==null)dict[contextApiUrl]=qd=new QueryContextData(contextApiUrl);return qd}var QueryContextData=/*#__PURE__*/function(){function QueryContextData(contextApiUrl){(0,_classCallCheck2["default"])(this,QueryContextData);this.contextApiUrl=void 0;this.contextData=void 0;this.contextApiUrl=contextApiUrl;this.contextData=this.queryContextData();this.revalidateContextData(false)}(0,_createClass2["default"])(QueryContextData,[{key:"revalidateContextData",value:function(){var _revalidateContextData=(0,_asyncToGenerator2["default"])(/*#__PURE__*/_regenerator["default"].mark(function _callee(exec){var _this=this;var newVal;return _regenerator["default"].wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!exec){_context.next=5;break}_context.next=3;return this.queryContextData();case 3:newVal=_context.sent;if(newVal!=null)this.contextData=newVal;case 5:setTimeout(function(){return _this.revalidateContextData(true)},30000);case 6:case"end":return _context.stop();}}},_callee,this)}));function revalidateContextData(_x){return _revalidateContextData.apply(this,arguments)}return revalidateContextData}()},{key:"getContextData",value:function getContextData(){return this.contextData}},{key:"queryContextData",value:function(){var _queryContextData=(0,_asyncToGenerator2["default"])(/*#__PURE__*/_regenerator["default"].mark(function _callee2(){var res;return _regenerator["default"].wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return fetch(this.contextApiUrl);case 3:res=_context2.sent;_context2.next=6;return res.json();case 6:return _context2.abrupt("return",_context2.sent);case 9:_context2.prev=9;_context2.t0=_context2["catch"](0);return _context2.abrupt("return",null);case 12:case"end":return _context2.stop();}}},_callee2,this,[[0,9]])}));function queryContextData(){return _queryContextData.apply(this,arguments)}return queryContextData}()}]);return QueryContextData}();exports.QueryContextData=QueryContextData;
//# sourceMappingURL=QueryContextData.js.map
"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");var _typeof=require("@babel/runtime/helpers/typeof");Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=void 0;var _toConsumableArray2=_interopRequireDefault(require("@babel/runtime/helpers/toConsumableArray"));var _slicedToArray2=_interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));var _react=_interopRequireWildcard(require("react"));var _propTypes=_interopRequireDefault(require("prop-types"));var _FilterOption=_interopRequireDefault(require("../FilterOption/FilterOption"));var _FilterText=_interopRequireDefault(require("../FilterText/FilterText"));var _FilterGrid=_interopRequireDefault(require("../FilterGrid/FilterGrid"));var _FilterRange=_interopRequireDefault(require("../FilterEngine/_FilterRange"));var _Filter=_interopRequireDefault(require("../Filter"));var _Constants=_interopRequireDefault(require("../Constants"));function _getRequireWildcardCache(nodeInterop){if(typeof WeakMap!=="function")return null;var cacheBabelInterop=new WeakMap;var cacheNodeInterop=new WeakMap;return(_getRequireWildcardCache=function _getRequireWildcardCache(nodeInterop){return nodeInterop?cacheNodeInterop:cacheBabelInterop})(nodeInterop)}function _interopRequireWildcard(obj,nodeInterop){if(!nodeInterop&&obj&&obj.__esModule){return obj}if(obj===null||_typeof(obj)!=="object"&&typeof obj!=="function"){return{"default":obj}}var cache=_getRequireWildcardCache(nodeInterop);if(cache&&cache.has(obj)){return cache.get(obj)}var newObj={};var hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj){if(key!=="default"&&Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;if(desc&&(desc.get||desc.set)){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}newObj["default"]=obj;if(cache){cache.set(obj,newObj)}return newObj}var uuidv4=require("uuid/v4");var FilterMore=function FilterMore(_ref){var isOpen=_ref.isOpen,filters=_ref.filters,onApply=_ref.onApply,isMobile=_ref.isMobile,label=_ref.label,noModal=_ref.noModal,header=_ref.header,className=_ref.className,onActives=_ref.onActives,height=_ref.height,item=_ref.item;var _useState=(0,_react.useState)(false),_useState2=(0,_slicedToArray2["default"])(_useState,2),valueOpen=_useState2[0],setValueOpen=_useState2[1];var _useState3=(0,_react.useState)([]),_useState4=(0,_slicedToArray2["default"])(_useState3,2),items=_useState4[0],setItems=_useState4[1];(0,_react.useEffect)(function(){setValueOpen(isOpen)},[isOpen]);(0,_react.useEffect)(function(){var fts=(0,_toConsumableArray2["default"])(filters);fts=fts.map(function(ft){if(ft.type==="range"&&!ft.rangeValue){Object.assign(ft,{rangeTitleValues:{min:ft.min,max:ft.max}});Object.assign(ft,{rangeValue:{min:ft.min,max:ft.max}});Object.assign(ft,{rangeTextValues:{min:ft.min,max:ft.max}});Object.assign(ft,{open:false})}return ft});setItems((0,_toConsumableArray2["default"])(fts))},[filters]);var filterActives=function filterActives(){return items.filter(function(filter){return filter.isActive})};var cleanFilter=function cleanFilter(){items.forEach(function(filter,index){if(filter.type===_Constants["default"].RANGE){items[index].rangeValue={min:items[index].min,max:items[index].max};items[index].rangeTextValues={min:items[index].min,max:items[index].max};items[index].isActive=false}if(filter.type===_Constants["default"].OPTIONS){filter.options.forEach(function(option){Object.assign(option,{checked:false})});items[index].isActive=false}if(filter.type===_Constants["default"].GRID){filter.options.forEach(function(option){Object.assign(option,{checked:false})});items[index].isActive=false}if(filter.type===_Constants["default"].TEXT){Object.assign(filter,{value:""});items[index].isActive=false}});setItems((0,_toConsumableArray2["default"])(items))};var handlerReset=function handlerReset(){cleanFilter();onApply(items);onActives(filterActives().length)};var handerFilters=function handerFilters(){var it=items.map(function(item,index){if(item.type===_Constants["default"].RANGE){return/*#__PURE__*/_react["default"].createElement(_FilterRange["default"],{key:uuidv4(),onChange:function onChange(_item){items[index]=_item;setItems((0,_toConsumableArray2["default"])(items))},values:{min:item.rangeValue.min,max:item.rangeValue.max},onActive:function onActive(isActive){items[index].isActive=isActive;setItems((0,_toConsumableArray2["default"])(items))},noModal:true,isMobile:isMobile,index:index,filters:items,filter:item})}if(item.type===_Constants["default"].OPTIONS){return/*#__PURE__*/_react["default"].createElement(_FilterOption["default"],{key:uuidv4(),isMobile:isMobile,noModal:true,onChange:function onChange(itemChange,options){Object.assign(items[index].options,options);setItems((0,_toConsumableArray2["default"])(items))},onActive:function onActive(isActive){items[index].isActive=isActive;setItems((0,_toConsumableArray2["default"])(items))},items:item.options,label:item.label})}if(item.type===_Constants["default"].GRID){return/*#__PURE__*/_react["default"].createElement(_FilterGrid["default"],{isMobile:isMobile,noModal:true,label:item.label,isAmenities:true,items:item.options,onChange:function onChange(itemChange,options){Object.assign(items[index].options,options);setItems((0,_toConsumableArray2["default"])(items))},onActive:function onActive(isActive){items[index].isActive=isActive;setItems((0,_toConsumableArray2["default"])(items))}})}if(item.type===_Constants["default"].TEXT){return/*#__PURE__*/_react["default"].createElement(_FilterText["default"],{onChange:function onChange(value){items[index].value=value;setItems((0,_toConsumableArray2["default"])(items))},onActive:function onActive(isActive){items[index].isActive=isActive;setItems((0,_toConsumableArray2["default"])(items))},value:item.value,label:item.label,noModal:true})}return[]});return it};var handleApply=function handleApply(){onApply(items);onActives(filterActives().length);setValueOpen(false)};// const value =
//   item.filterTitle && item.filterTitle.length > 0 ? item.filterTitle : [""];
// const isActive =
//   isMobile || !item.filterTitle ? false : filterActives().length > 0;
var handleClose=function handleClose(){if(!isMobile)setValueOpen(false);if(!item.isActive)cleanFilter()};return/*#__PURE__*/_react["default"].createElement(_Filter["default"],{type:"list",more:true,isMobile:isMobile,label:label,noModal:noModal,onOpen:function onOpen(){return!isMobile&&setValueOpen(true)},isOpen:valueOpen,onClose:handleClose,onApply:function onApply(){return handleApply()},items:handerFilters(),onReset:function onReset(){return handlerReset()},isActive:item.isActive,sufix:"- Mais Filtros",value:item.value,qtdFilters:filterActives().length// value={filterActives().length === 1 ? [1] : filterActives()}
,disabled:!filterActives().length>0,header:header,className:className,height:height})};FilterMore.defaultProps={onApply:function onApply(){},onActives:function onActives(){},isOpen:false,isMobile:false,label:"",noModal:false,header:"",filters:[]};FilterMore.propTypes={isOpen:_propTypes["default"].bool,filters:_propTypes["default"].arrayOf(_propTypes["default"].shape({type:_propTypes["default"].string,label:_propTypes["default"].string,field:_propTypes["default"].string})),onActives:_propTypes["default"].func,onApply:_propTypes["default"].func,isMobile:_propTypes["default"].bool,label:_propTypes["default"].string,noModal:_propTypes["default"].bool,header:_propTypes["default"].string};var _default=FilterMore;exports["default"]=_default;
//# sourceMappingURL=FilterMore.js.map
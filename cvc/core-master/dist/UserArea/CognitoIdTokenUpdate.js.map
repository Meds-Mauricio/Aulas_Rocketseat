{"version":3,"sources":["../../src/UserArea/CognitoIdTokenUpdate.ts"],"names":["window","originalSetItem","localStorage","setItem","key","value","startsWith","endsWith","event","CustomEvent","document","dispatchEvent","apply","originalRemoveItem","removeItem","Event","useLocalStorage","React","useState","cognitoIdToken","setIdToken","getCognitoIdToken","e","customEvent","detail","deleteCognitoServiceProvider","Object","keys","removeCognitoIdToken","undefined","useEffect","addEventListener","removeEventListener"],"mappings":"oUAEA,oD,o/BAFA,yC,CACA,uCAGA,GAAI,MAAOA,CAAAA,MAAP,GAAkB,WAAtB,CAAmC,CAC/B,GAAMC,CAAAA,eAAe,CAAGC,YAAY,CAACC,OAArC,CACA;AACAD,YAAY,CAACC,OAAb,CAAuB,SAAUC,GAAV,CAAuBC,KAAvB,CAAsC,CACzD,GAAID,GAAG,CAACE,UAAJ,CAAe,gCAAf,GAAoDF,GAAG,CAACG,QAAJ,CAAa,SAAb,CAAxD,CAAiF,CAC7E,GAAMC,CAAAA,KAAK,CAAG,GAAIC,CAAAA,WAAJ,CAAgB,mBAAhB,CAAqC,CAC/C,SAAU,CAAE,MAAOL,GAAT,CAAc,QAASC,KAAvB,CADqC,CAArC,CAAd,CAGAK,QAAQ,CAACC,aAAT,CAAuBH,KAAvB,CAEH,CACDP,eAAe,CAACW,KAAhB,CAAsB,IAAtB,CAA4B,CAACR,GAAD,CAAMC,KAAN,CAA5B,CACH,CATD,CAWA,GAAMQ,CAAAA,kBAAkB,CAAIX,YAAY,CAACY,UAAzC,CAEA;AACAZ,YAAY,CAACY,UAAb,CAA0B,SAAUV,GAAV,CAAuB,CAC7C,GAAIA,GAAG,CAACE,UAAJ,CAAe,gCAAf,GAAoDF,GAAG,CAACG,QAAJ,CAAa,SAAb,CAAxD,CAAiF,CAC7E,GAAMC,CAAAA,KAAK,CAAG,GAAIO,CAAAA,KAAJ,CAAU,sBAAV,CAAd,CACAL,QAAQ,CAACC,aAAT,CAAuBH,KAAvB,CACH,CACDK,kBAAkB,CAACD,KAAnB,CAAyB,IAAzB,CAA+B,CAACR,GAAD,CAA/B,CACH,CACJ,CACD;AACA,QAASY,CAAAA,eAAT,EAA2B,CAEvB,oBAAqCC,KAAK,CAACC,QAAN,EAArC,oEAAOC,cAAP,qBAAuBC,UAAvB,qBAEA,GAAMC,CAAAA,iBAAiB,CAAG,QAApBA,CAAAA,iBAAoB,CAACC,CAAD,CAAc,CACpC,GAAMC,CAAAA,WAAwB,CAAGD,CAAjC,CACAF,UAAU,CAACG,WAAW,CAACC,MAAZ,CAAmBnB,KAApB,CACb,CAHD,CAKA,GAAMoB,CAAAA,4BAA4B,CAAG,QAA/BA,CAAAA,4BAA+B,EAAM,CACvC;AACA,0BAAgBC,MAAM,CAACC,IAAP,CAAYzB,YAAZ,CAAhB,6BAA2C,CAAtC,GAAIE,CAAAA,GAAG,iBAAP,CACD,GAAIA,GAAG,CAACE,UAAJ,CAAe,gCAAf,CAAJ,CAAsD,CAClDJ,YAAY,CAACY,UAAb,CAAwBV,GAAxB,CACH,CACJ,CACJ,CAPD,CASA,GAAMwB,CAAAA,oBAAoB,CAAG,QAAvBA,CAAAA,oBAAuB,EAAM,CAC/BR,UAAU,CAACS,SAAD,CAEb,CAHD,CAKAZ,KAAK,CAACa,SAAN,CAAgB,UAAM,CAClBpB,QAAQ,CAACqB,gBAAT,CAA0B,mBAA1B,CACIV,iBADJ,CAEI,KAFJ,EAIAX,QAAQ,CAACqB,gBAAT,CAA0B,sBAA1B,CACIH,oBADJ,CAEI,KAFJ,EAIA,MAAO,kBAAMlB,CAAAA,QAAQ,CAACsB,mBAAT,CAA6B,eAA7B,CAA8CX,iBAA9C,CAAN,CACV,CAVD,CAUG,EAVH,EAYA,MAAO,CAAEF,cAAc,CAAdA,cAAF,CAAkBM,4BAA4B,CAA5BA,4BAAlB,CACV,C,aAEcT,e","sourcesContent":["/* eslint-disable no-restricted-syntax */\n/* eslint-disable prefer-rest-params */\nimport * as React from \"react\"\n\nif (typeof window !== \"undefined\") {\n    const originalSetItem = localStorage.setItem\n    // eslint-disable-next-line func-names\n    localStorage.setItem = function (key: string, value: string) {\n        if (key.startsWith(\"CognitoIdentityServiceProvider\") && key.endsWith(\"idToken\")) {\n            const event = new CustomEvent(\"setCognitoIdToken\", {\n                \"detail\": { \"key\": key, \"value\": value }\n            })\n            document.dispatchEvent(event)\n\n        }\n        originalSetItem.apply(this, [key, value])\n    }\n\n    const originalRemoveItem =  localStorage.removeItem\n\n    // eslint-disable-next-line func-names\n    localStorage.removeItem = function (key: string) {\n        if (key.startsWith(\"CognitoIdentityServiceProvider\") && key.endsWith(\"idToken\")) {\n            const event = new Event(\"removeCognitoIdToken\")\n            document.dispatchEvent(event)\n        }\n        originalRemoveItem.apply(this, [key])\n    }\n}\n// eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types\nfunction useLocalStorage() {\n\n    const [cognitoIdToken, setIdToken] = React.useState<string | null | undefined>()\n\n    const getCognitoIdToken = (e: Event) => {\n        const customEvent: CustomEvent = e as CustomEvent;\n        setIdToken(customEvent.detail.value);\n    }\n\n    const deleteCognitoServiceProvider = () => {\n        // eslint-disable-next-line vars-on-top\n        for (var key of Object.keys(localStorage)) {\n            if (key.startsWith(\"CognitoIdentityServiceProvider\")) {\n                localStorage.removeItem(key)\n            }\n        }\n    }\n\n    const removeCognitoIdToken = () => {\n        setIdToken(undefined);\n\n    }\n\n    React.useEffect(() => {\n        document.addEventListener(\"setCognitoIdToken\",\n            getCognitoIdToken,\n            false)\n\n        document.addEventListener(\"removeCognitoIdToken\",\n            removeCognitoIdToken,\n            false)\n\n        return () => document.removeEventListener(\"storageChange\", getCognitoIdToken)\n    }, [])\n\n    return { cognitoIdToken, deleteCognitoServiceProvider }\n}\n\nexport default useLocalStorage\n"],"file":"CognitoIdTokenUpdate.js"}
{"version":3,"sources":["../../src/FilterEngine/FilterEngine.js"],"names":["FilterEngine","props","filters","dataSource","onFiltred","onApply","classes","activeFilterMore","height","items","setItems","fts","map","ft","Object","assign","open","type","filterTitle","rangeTitleValues","min","max","rangeValue","rangeTextValues","value","active","length","isOpen","find","filter","filterGrid","item","values","options","forFilter","optionStart","newValues","o","checked","forEach","option","dsOptions","operator","opts","el","field","code","opt","push","filterOptions","filterRange","range","cond","filterText","texts","toUpperCase","includes","onClientApply","index","filterSelected","obj","_filter","Filters","RANGE","_items","OPTIONS","GRID","TEXT","MORE","filterActives","f","isActive","isMobile","_item","newItems","defaultProps","propTypes","PropTypes","func","styles","withTheme"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { withStyles } from \"@material-ui/core/styles\";\nimport { Filters } from \"@cvccorp-components/core\";\nimport PropTypes from \"prop-types\";\nimport { get, filter } from \"lodash\";\nimport FilterRange from \"./_FilterRange\";\nimport FilterOption from \"./_FilterOption\";\nimport FilterGrid from \"./_FilterGrid\";\nimport FilterText from \"./_FilterText\";\nimport FilterMore from \"./_FilterMore\";\n\nimport { styles } from \"./styles\";\n\nconst FilterEngine = props => {\n    const { filters, dataSource, onFiltred, onApply, classes, activeFilterMore, height } = props;\n\n    const [items, setItems] = useState([]);\n\n    useEffect(() => {\n        let fts = [...filters];\n\n        fts = fts.map(ft => {\n            Object.assign(ft, { open: false });\n            if (ft.type === \"range\") {\n                Object.assign(ft, { filterTitle: \"\" });\n                Object.assign(ft, { rangeTitleValues: { min: ft.min, max: ft.max } });\n                Object.assign(ft, { rangeValue: { min: ft.min, max: ft.max } });\n                Object.assign(ft, { rangeTextValues: { min: ft.min, max: ft.max } });\n            }\n            if (ft.type === \"filterMore\") {\n                Object.assign(ft, { value: [\"\"] });\n                Object.assign(ft, { active: false });\n            }\n            return ft;\n        });\n\n        setItems([...fts]);\n    }, []);\n\n    useEffect(() => {\n        let fts = items;\n        \n        if (fts.length) {\n            fts = fts.map(ft => {\n                if (ft.type === \"filterMore\") {\n                    return { ...ft, isOpen: filters.find(filter => filter.type === \"filterMore\").isOpen };\n                }\n                return ft;\n            });\n            setItems([...fts]);\n        }\n    }, [filters]);\n\n    // FILTER_GRID\n    const filterGrid = (item, values) => {\n        let options = item.forFilter ? item.forFilter : item.options;\n        let optionStart = false;\n        let newValues = [];\n\n        options = options.filter(o => {\n            return o.checked;\n        });\n\n        if (options.length === 0) return values;\n\n        options.forEach(option => {\n            let dsOptions = [];\n            if (item.operator === \"or\") dsOptions = values;\n            if (item.operator === \"and\") dsOptions = !optionStart ? values : [newValues];\n\n            const opts = filter(dsOptions, el => {\n                if (typeof item.field === \"string\") {\n                    return get(el, item.field, {}) === option.code;\n                }\n\n                return item.field(el, option);\n            });\n\n            if (!optionStart) optionStart = true;\n            if (item.operator === \"or\") opts.forEach(opt => newValues.push(opt));\n            if (item.operator === \"and\") newValues = opts;\n        });\n        return newValues;\n    };\n\n    // FILTER_OPTIONS\n    const filterOptions = (item, values) => {\n        let options = item.forFilter ? item.forFilter : item.options;\n        let optionStart = false;\n        let newValues = [];\n\n        options = options.filter(o => {\n            return o.checked;\n        });\n\n        if (options.length === 0) return values;\n\n        options.forEach(option => {\n            let dsOptions = [];\n            if (item.operator === \"or\") dsOptions = values;\n            if (item.operator === \"and\") dsOptions = !optionStart ? values : [newValues];\n\n            const opts = filter(dsOptions, el => {\n                if (typeof item.field === \"string\") {\n                    return get(el, item.field, {}) === option.value;\n                }\n\n                return item.field(el, option);\n            });\n\n            if (!optionStart) optionStart = true;\n            if (item.operator === \"or\") opts.forEach(opt => newValues.push(opt));\n            if (item.operator === \"and\") newValues = opts;\n        });\n        return newValues;\n    };\n\n    // FILTER_RANGE\n    const filterRange = (item, values) => {\n        const value = item.rangeValue ? item.rangeValue : { min: item.min, max: item.max };\n        const range = filter(values, el => {\n            const cond = get(el, item.field, {});\n            return cond >= value.min && cond <= value.max;\n        });\n        return range;\n    };\n\n    // FILTER_TEXT\n    const filterText = (item, values) => {\n        const value = item.forFilter ? item.forFilter : item.value;\n        if (!value) return values;\n\n        const texts = filter(values, el => {\n            const cond = get(el, item.field, {});\n            return cond.toUpperCase().includes(value.toUpperCase());\n        });\n        return texts;\n    };\n\n    // ON_APLLY\n    const onClientApply = (value, ft, index) => {\n        let values = [...dataSource];\n        const filterSelected = items[index];\n\n        if (ft.type === \"filterMore\" && value.length) {\n            value.forEach(obj => {\n                if (obj.type === \"range\") values = [...filterRange(obj, values)];\n                if (obj.type === \"options\") values = [...filterOptions(obj, values)];\n                if (obj.type === \"grid\") values = [...filterGrid(obj, values)];\n                if (obj.type === \"text\") values = [...filterText(obj, values)];\n            });\n        }\n\n        if (ft.type === \"range\")\n            filterSelected.forFilter = {\n                min: value.min,\n                max: value.max\n            };\n\n        if (ft.type === \"options\" || ft.type === \"grid\" || ft.type === \"text\") filterSelected.forFilter = value;\n\n        items.forEach(obj => {\n            if (obj.type === \"range\") values = [...filterRange(obj, values)];\n            if (obj.type === \"options\") values = [...filterOptions(obj, values)];\n            if (obj.type === \"grid\") values = [...filterGrid(obj, values)];\n            if (obj.type === \"text\") values = [...filterText(obj, values)];\n        });\n\n        if (onFiltred) onFiltred(values);\n    };\n\n    return items.map((item, index) => {\n        const { type } = item;\n        let _filter = null;\n\n        if (type === Filters.RANGE) {\n            _filter = (\n                <FilterRange\n                    onApply={_items => {\n                        const value = _items[index].rangeTextValues;\n                        if (dataSource) onClientApply(value, item, index);\n                        else onApply({ value, item: _items[index], index });\n                    }}\n                    index={index}\n                    filters={items}\n                    filter={item}\n                    className={classes.item}\n                    height={height}\n                />\n            );\n        }\n        if (type === Filters.OPTIONS) {\n            _filter = (\n                <FilterOption\n                    onApply={_items => {\n                        const value = _items[index].options;\n                        if (dataSource) onClientApply(value, item, index);\n                        else if (onApply) onApply({ value, item, index });\n                    }}\n                    index={index}\n                    filters={items}\n                    filter={item}\n                    className={classes.item}\n                    height={height}\n                />\n            );\n        }\n        if (type === Filters.GRID) {\n            _filter = (\n                <FilterGrid\n                    onApply={_items => {\n                        const value = _items[index].options;\n                        if (dataSource) onClientApply(value, item, index);\n                        else if (onApply) onApply({ value, item, index });\n                    }}\n                    index={index}\n                    filters={items}\n                    filter={item}\n                    filterObj={item}\n                    className={classes.item}\n                    height={height}\n                />\n            );\n        }\n        if (type === Filters.TEXT) {\n            _filter = (\n                <FilterText\n                    onApply={_items => {\n                        const { value } = _items[index];\n                        if (dataSource) onClientApply(value, item, index);\n                        else if (onApply) onApply({ value, item: _items[index], index });\n                    }}\n                    index={index}\n                    filters={items}\n                    filter={item}\n                    className={classes.item}\n                    height={height}\n                />\n            );\n        }\n        if (type === Filters.MORE) {\n            return (\n                <FilterMore\n                    onApply={values => {\n                        const filterActives = values.filter(f => f.isActive);\n                        const filterTitle = filterActives.length === 1 ? [1] : filterActives.length === 0 ? \"\" : filterActives;\n                        const value = filterTitle;\n                        const isActive = item.isMobile || filterTitle === \"\" ? false : filterActives.length > 0;\n\n                        const _item = { ...item, filterTitle, value, isActive, filters: [...values] };\n                        const newItems = items;\n                        newItems[index] = _item;\n                        setItems([...newItems]);\n                        if (dataSource) onClientApply(values, item, index);\n                        else if (onApply) onApply({ value, item: _item, index });\n                    }}\n                    item={item}\n                    classes={classes}\n                    onActives={value => activeFilterMore(value)}\n                    height={height}\n                />\n            );\n        }\n\n        return _filter;\n    });\n};\n\nFilterEngine.defaultProps = {\n    activeFilterMore: () => { }\n};\n\nFilterEngine.propTypes = {\n    activeFilterMore: PropTypes.func\n};\n\nexport default withStyles(styles, { withTheme: true })(FilterEngine);\n"],"file":"FilterEngine.js"}
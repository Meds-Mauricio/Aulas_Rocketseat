{"version":3,"sources":["../../src/ProfileContext/index.tsx"],"names":["ProfileContext","ProfileDataProvider","children","ctx","BrandContext","userIdToken","profileData","setProfileData","profileLoading","setProfileLoading","isPatchProfileScreen","setIsPatchProfileScreen","isRegisterUserProfileStep","setIsRegisterUserProfileStep","getProfileInformations","token","api","defaults","headers","authorization","get","hosts","profile","data","userId","length","window","fingerprint","storeUserId","patchProfile","birthdate","contact","cpf","name","acceptedMaisCVC","patch","console","log","setIsPatchProfileScreenToggle","isProfileScreen","setIsRegisterUserProfileStepToggle","isRegisterProfile","useProfileContext","context"],"mappings":"0iBAAA,qDACA,6CACA,uDACA,yEAEA,2CACA,+B,o/BAGA,GAAMA,CAAAA,cAAc,cAAG,yBAA+B,EAA/B,CAAvB,CAMA,GAAMC,CAAAA,mBAA+C,CAAG,QAAlDA,CAAAA,mBAAkD,MAAoC,IAAjCC,CAAAA,QAAiC,MAAjCA,QAAiC,CACxF,GAAMC,CAAAA,GAAG,CAAG,sBAAWC,0BAAX,CAAZ,CACA,wBAAsB,qCAAtB,CAAOC,WAAP,qBAAOA,WAAP,CACA,cAAsC,oBAAuB,EAAvB,CAAtC,wDAAOC,WAAP,eAAoBC,cAApB,eACA,eAA4C,oBAAS,KAAT,CAA5C,yDAAOC,cAAP,eAAuBC,iBAAvB,eACA,eAAwD,oBAAS,KAAT,CAAxD,yDAAOC,oBAAP,eAA6BC,uBAA7B,eACA,eAAkE,oBAAS,KAAT,CAAlE,yDAAOC,yBAAP,eAAkCC,4BAAlC,eAEA,GAAMC,CAAAA,sBAAsB,CAAG,gHAAY,yJACvCL,iBAAiB,CAAC,IAAD,CAAjB,CADuC,gBAG7BM,KAH6B,CAGrBV,WAAW,EAAI,+BAHM,KAIhCU,KAJgC,yBAK/BC,gBAAIC,QAAJ,CAAaC,OAAb,CAAqBC,aAArB,kBAA+CJ,KAA/C,EAL+B,sBAMRC,iBAAII,GAAJ,WAAW,kBAASjB,GAAG,CAACkB,KAAb,CAAX,gCANQ,QAMzBC,OANyB,eAO/B,GAAIA,OAAO,CAACC,IAAR,CAAaC,MAAb,EAAuBF,OAAO,CAACC,IAAR,CAAaC,MAAb,CAAoBC,MAApB,CAA6B,CAAxD,CAA2D,CACvD,GAAIC,MAAD,EAAoBA,MAAD,CAAgBC,WAAtC,CAAmD,CAC9CD,MAAD,CAAgBC,WAAhB,CAA4BC,WAA5B,CAAwCN,OAAO,CAACC,IAAR,CAAaC,MAArD,CACH,CACJ,CACDjB,cAAc,CAACe,OAAD,SAACA,OAAD,iBAACA,OAAO,CAAEC,IAAV,CAAd,CACAd,iBAAiB,CAAC,KAAD,CAAjB,CAb+B,gCAcxBa,OAdwB,SAcxBA,OAdwB,iBAcxBA,OAAO,CAAEC,IAde,2FAiBnC;AACAd,iBAAiB,CAAC,KAAD,CAAjB,CAlBmC,oEAAZ,GAqB5B,CAACN,GAAG,CAACkB,KAAL,CAAYhB,WAAZ,CArB4B,CAA/B,CAuBA,GAAMwB,CAAAA,YAAY,CAAG,qIAAY,qMAAOC,SAAP,OAAOA,SAAP,CAAkBC,OAAlB,OAAkBA,OAAlB,CAA2BC,GAA3B,OAA2BA,GAA3B,CAAgCC,IAAhC,OAAgCA,IAAhC,CAAsCC,eAAtC,OAAsCA,eAAtC,CAC7BzB,iBAAiB,CAAC,IAAD,CAAjB,CACMc,IAFuB,CAEhB,CACTU,IAAI,CAAJA,IADS,CAETH,SAAS,CAATA,SAFS,CAGTE,GAAG,CAAHA,GAHS,CAITD,OAAO,CAAPA,OAJS,CAKTG,eAAe,CAAfA,eALS,CAFgB,kBAUzBlB,gBAAIC,QAAJ,CAAaC,OAAb,CAAqBC,aAArB,kBAA+Cd,WAA/C,EAVyB,uBAWnBW,iBAAImB,KAAJ,WAAa,kBAAShC,GAAG,CAACkB,KAAb,CAAb,gCAA+DE,IAA/D,CAXmB,+BAYnBT,CAAAA,sBAAsB,EAZH,QAazBL,iBAAiB,CAAC,KAAD,CAAjB,CAbyB,qFAezB2B,OAAO,CAACC,GAAR,CAAY,QAAZ,eAA2B;AAC3B5B,iBAAiB,CAAC,KAAD,CAAjB,CAhByB,sEAAZ,8DAmBlB,CAACJ,WAAD,CAAcS,sBAAd,CAnBkB,CAArB,CAqBA,GAAMwB,CAAAA,6BAA6B,CAAG,uBAAY,SAACC,eAAD,CAA8B,CAC5E5B,uBAAuB,CAAC4B,eAAD,CAC1B,CAFqC,CAEnC,EAFmC,CAAtC,CAIA,GAAMC,CAAAA,kCAAkC,CAAG,uBAAY,SAACC,iBAAD,CAA+B,CAClF5B,4BAA4B,CAAC4B,iBAAD,CAC/B,CAF0C,CAExC,EAFwC,CAA3C,CAIA,mBACI,gCAAC,cAAD,CAAgB,QAAhB,EAAyB,KAAK,CAAE,CAC5BnC,WAAW,CAAXA,WAD4B,CAE5BQ,sBAAsB,CAAtBA,sBAF4B,CAG5Be,YAAY,CAAZA,YAH4B,CAI5BrB,cAAc,CAAdA,cAJ4B,CAK5BE,oBAAoB,CAApBA,oBAL4B,CAM5B4B,6BAA6B,CAA7BA,6BAN4B,CAO5B1B,yBAAyB,CAAzBA,yBAP4B,CAQ5B4B,kCAAkC,CAAlCA,kCAR4B,CAS5BjC,cAAc,CAAdA,cAT4B,CAAhC,EAWKL,QAXL,CAcP,CA3ED,C,gDA6EA,QAASwC,CAAAA,iBAAT,EAA8C,CAC1C,GAAMC,CAAAA,OAAO,CAAG,sBAAW3C,cAAX,CAAhB,CACA,MAAO2C,CAAAA,OACV","sourcesContent":["import React, { createContext, ReactNode, useCallback, useContext, useEffect, useState } from \"react\";\nimport { BrandContext } from \"../BrandContext\"\nimport { Redirect } from \"../BrandContext/amplify/aws.config\"\nimport api from \"../BrandContext/services/api\";\nimport { useToast } from \"../MyTravelLogin/contexts/Toast\";\nimport { useUserDataContext } from \"../UserContext\";\nimport { findCognitoIdToken } from \"../utils\";\nimport { IPatchProfile, IProfileContext, IProfileData } from \"./types\";\n\nconst ProfileContext = createContext<IProfileContext>({} as IProfileContext);\n\ninterface IProfileProvider {\n    children: ReactNode;\n}\n\nconst ProfileDataProvider: React.FC<IProfileProvider> = ({ children }: IProfileProvider) => {\n    const ctx = useContext(BrandContext);\n    const {userIdToken} = useUserDataContext()\n    const [profileData, setProfileData] = useState<IProfileData>({} as IProfileData);\n    const [profileLoading, setProfileLoading] = useState(false)\n    const [isPatchProfileScreen, setIsPatchProfileScreen] = useState(false)\n    const [isRegisterUserProfileStep, setIsRegisterUserProfileStep] = useState(false)\n\n    const getProfileInformations = useCallback(async () => {\n        setProfileLoading(true)\n        try {\n            const token = userIdToken || findCognitoIdToken()\n            if(token){\n                api.defaults.headers.authorization = `Bearer ${token}`;\n                const profile =  await api.get(`${Redirect(ctx.hosts)}/api/my-travels-bff/profile`)\n                if (profile.data.userId && profile.data.userId.length > 0) {\n                    if((window as any) && (window as any).fingerprint) {\n                        (window as any).fingerprint.storeUserId(profile.data.userId);\n                    }\n                }\n                setProfileData(profile?.data)\n                setProfileLoading(false)\n                return profile?.data\n            }\n        } catch {\n            // precisamos tratar essa\n            setProfileLoading(false)\n        }\n\n    }, [ctx.hosts, userIdToken]);\n\n    const patchProfile = useCallback(async({birthdate, contact, cpf, name, acceptedMaisCVC}: IPatchProfile) => {\n        setProfileLoading(true)\n        const data = {\n            name,\n            birthdate,\n            cpf,\n            contact,\n            acceptedMaisCVC\n        }\n        try {\n            api.defaults.headers.authorization = `Bearer ${userIdToken}`;\n            await api.patch(`${Redirect(ctx.hosts)}/api/my-travels-bff/profile`, data)\n            await getProfileInformations()\n            setProfileLoading(false)\n        } catch (err){\n            console.log(\"Erro: \", err) // Tratar esse erro com o Mauricio amanha\n            setProfileLoading(false)\n        }\n\n    }, [userIdToken, getProfileInformations])\n\n    const setIsPatchProfileScreenToggle = useCallback((isProfileScreen: boolean) => {\n        setIsPatchProfileScreen(isProfileScreen)\n    }, [])\n\n    const setIsRegisterUserProfileStepToggle = useCallback((isRegisterProfile: boolean)=> {\n        setIsRegisterUserProfileStep(isRegisterProfile)\n    }, [])\n\n    return (\n        <ProfileContext.Provider value={{\n            profileData,\n            getProfileInformations,\n            patchProfile,\n            profileLoading,\n            isPatchProfileScreen,\n            setIsPatchProfileScreenToggle,\n            isRegisterUserProfileStep,\n            setIsRegisterUserProfileStepToggle,\n            setProfileData\n        }}>\n            {children}\n        </ProfileContext.Provider>\n    );\n};\n\nfunction useProfileContext(): IProfileContext {\n    const context = useContext(ProfileContext);\n    return context;\n}\n\nexport { ProfileDataProvider, useProfileContext };\n"],"file":"index.js"}
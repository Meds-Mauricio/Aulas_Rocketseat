{"version":3,"sources":["../../src/UserContext/index.tsx"],"names":["UserDataContext","UserDataProvider","config","children","isConfig","setisConfig","isUserAuth","setisUserAuth","currentUser","setCurrentUser","userIdToken","setIdToken","cookies","Cookies","saveOnGa","setIsConfig","Auth","currentAuthenticatedUser","attributes","setIsUserAuth","isAuth","setUserIdToken","idToken","logout","noReload","willBeSavedInGA","signOut","remove","path","window","fingerprint","removeUserId","localStorage","removeItem","event","category","action","label","location","reload","useUserDataContext","context"],"mappings":"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","sourcesContent":["import React, { createContext, ReactNode, useCallback, useContext, useEffect, useState } from \"react\";\nimport { Auth } from \"aws-amplify\";\nimport { AuthClass } from \"aws-amplify/dist/aws-amplify\"\nimport Cookies from \"universal-cookie\";\nimport useGa from \"../utils/useGa\";\n\ninterface ILogout {\n    noReload?: boolean\n    willBeSavedInGA?: boolean\n}\n\ninterface IUserDataContext {\n    currentUser: any\n    isUserAuth: boolean;\n    setIsUserAuth(isUserAuth): void;\n    Auth: AuthClass;\n    isConfig: boolean;\n    setIsConfig(): Promise<void>\n    setUserIdToken(idToken: string): void\n    userIdToken: string\n    logout(iLogout?: ILogout): Promise<void>\n}\n\ndeclare global {\n    interface Window {\n        fingerprint: any;\n    }\n}\n\ninterface IUserProvider {\n    config: any;\n    children: ReactNode;\n}\n\nconst UserDataContext = createContext<IUserDataContext>({} as IUserDataContext);\n\nconst UserDataProvider: React.FC<IUserProvider> = ({ config, children }: IUserProvider) => {\n    const [isConfig, setisConfig] = useState(false);\n    const [isUserAuth, setisUserAuth] = useState(false);\n    const [currentUser, setCurrentUser] = useState({});\n    const [userIdToken, setIdToken] = useState(\"\")\n\n    const cookies = new Cookies();\n    const { saveOnGa } = useGa();\n\n    useEffect(() => {\n        if (config) {\n            setIsConfig()\n        }\n    }, [config])\n\n    const setIsConfig = async () => {\n        try {\n            await Auth.currentAuthenticatedUser();\n            setisUserAuth(true);\n            const { attributes } = await Auth.currentAuthenticatedUser();\n            setCurrentUser(attributes);\n        } catch (error) {\n            setisUserAuth(false);\n        }\n        setisConfig(true);\n    }\n\n    const setIsUserAuth = (isAuth) => {\n        setisUserAuth(isAuth);\n\n    }\n\n    const setUserIdToken = useCallback((idToken: string) => {\n        setIdToken(idToken)\n    }, [])\n\n    const logout = useCallback(async ({noReload, willBeSavedInGA}: ILogout) => {\n        await Auth.signOut();\n        setIsUserAuth(false);\n\n        cookies.remove(\"corpAgentId\", {\n            path: \"/\"\n        });\n        cookies.remove(\"agentId\", {\n            path: \"/\"\n        });\n        cookies.remove(\"branchId\", {\n            path: \"/\"\n        });\n        cookies.remove(\"access_token\", {\n            path: \"/\"\n        });\n\n        if (typeof window !== \"undefined\" && window.fingerprint) {\n            window.fingerprint.removeUserId();\n        }\n\n        localStorage.removeItem(\"user_email\");\n\n        if(willBeSavedInGA) {\n            saveOnGa({\n                event: \"header_event\",\n                category: \"Account\",\n                action: \"Click on header options\",\n                label: \"click on header item :: logout\"\n            });\n        }\n        if(!noReload){\n            window.location.reload();\n        }\n\n    }, [saveOnGa])\n\n    return (\n        <UserDataContext.Provider value={{\n            currentUser,\n            isUserAuth,\n            setIsUserAuth,\n            Auth,\n            isConfig,\n            setIsConfig,\n            setUserIdToken,\n            userIdToken,\n            logout\n        }}>\n            {children}\n        </UserDataContext.Provider>\n    );\n};\n\nfunction useUserDataContext(): IUserDataContext {\n    const context = useContext(UserDataContext);\n    return context;\n}\n\nexport { UserDataProvider, useUserDataContext };\n"],"file":"index.js"}
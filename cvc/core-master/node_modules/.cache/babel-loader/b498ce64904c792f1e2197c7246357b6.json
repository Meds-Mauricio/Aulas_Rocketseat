{"ast":null,"code":"import _slicedToArray from \"C:/Users/felip/OneDrive/Dokumente/cvc/core-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _jsxFileName = \"C:\\\\Users\\\\felip\\\\OneDrive\\\\Dokumente\\\\cvc\\\\core-master\\\\src\\\\Image\\\\Image.js\",\n    _this = this,\n    _s = $RefreshSig$();\n\nimport React, { useContext, useState } from \"react\";\nimport { BrandContext } from \"../BrandContext/BrandContext\";\nimport { withStyles } from \"@material-ui/styles\";\nimport PropTypes from \"prop-types\";\nimport { styles } from \"./styles\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nvar Image = function Image(props) {\n  _s();\n\n  // TODO rever implementação do contexto\n  var company = useContext(BrandContext);\n  var imageUrl = company ? \"\".concat(company.imageProcessorPath, \"image/fetch\") : \"\";\n\n  var _useState = useState(mountSrcUrl(props, imageUrl)),\n      _useState2 = _slicedToArray(_useState, 2),\n      imgUrl = _useState2[0],\n      setImgUrl = _useState2[1];\n\n  var _useState3 = useState(0),\n      _useState4 = _slicedToArray(_useState3, 2),\n      fallbackPosition = _useState4[0],\n      setFallbackPosition = _useState4[1];\n\n  var alt = props.alt,\n      className = props.className;\n\n  var onError = function onError() {\n    if (props.fallback || props.fallbackUrl) {\n      var properties = {\n        src: props.fallbackUrl ? props.fallbackUrl : props.fallback[fallbackPosition],\n        width: props.width,\n        height: props.height\n      };\n      var newImgUrl = mountSrcUrl(properties, imageUrl);\n      setImgUrl(newImgUrl);\n      props.fallback && setFallbackPosition(function (prevState) {\n        return prevState + 1;\n      });\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: /*#__PURE__*/_jsxDEV(\"img\", {\n      src: imgUrl,\n      alt: alt,\n      className: className,\n      onError: onError\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 26,\n      columnNumber: 13\n    }, _this)\n  }, void 0, false);\n};\n\n_s(Image, \"AFRlMwuv5PqHiLBabH+HOfcJauc=\");\n\n_c = Image;\nImage.propTypes = {\n  className: PropTypes.string,\n  alt: PropTypes.string,\n  src: PropTypes.string.isRequired,\n  fallbackUrl: PropTypes.string,\n  fallback: PropTypes.array,\n  width: PropTypes.number,\n  height: PropTypes.number\n};\n/**\n * Mounts the url based on the component props\n * The sequence of efects matters! The effect is applyed to the output of the previous one\n */\n\nfunction mountSrcUrl(_ref, imageUrl) {\n  var src = _ref.src,\n      width = _ref.width,\n      height = _ref.height;\n  imageUrl = improveOriginalImage(imageUrl);\n  imageUrl = scaleImage(imageUrl, width, height);\n  return \"\".concat(imageUrl, \"/\").concat(src);\n}\n/**\n * Width - adds width and Height dimensions\n */\n\n\nfunction scaleImage(path, width, height) {\n  var pathSlices = [\"c_fill\"];\n  if (width) pathSlices.unshift(\"w_\".concat(width));\n  if (height) pathSlices.unshift(\"h_\".concat(height));\n  return \"\".concat(path, \"/\").concat(pathSlices.join(\",\"));\n}\n/**\n * Sharpen - Improves contrast without loosing quality\n */\n\n\nfunction improveOriginalImage(path) {\n  var step1 = [\"e_trim\"];\n  var step2 = [\"e_sharpen\", \"f_auto\", \"fl_lossy\"];\n  var steps = [step1.join(\",\"), step2.join(\",\")];\n  return \"\".concat(path, \"/\").concat(steps.join(\"/\"));\n}\n\nImage.__docgenInfo = {\n  \"description\": \"\",\n  \"methods\": [],\n  \"displayName\": \"Image\",\n  \"props\": {\n    \"className\": {\n      \"type\": {\n        \"name\": \"string\"\n      },\n      \"required\": false,\n      \"description\": \"\"\n    },\n    \"alt\": {\n      \"type\": {\n        \"name\": \"string\"\n      },\n      \"required\": false,\n      \"description\": \"\"\n    },\n    \"src\": {\n      \"type\": {\n        \"name\": \"string\"\n      },\n      \"required\": true,\n      \"description\": \"\"\n    },\n    \"fallbackUrl\": {\n      \"type\": {\n        \"name\": \"string\"\n      },\n      \"required\": false,\n      \"description\": \"\"\n    },\n    \"fallback\": {\n      \"type\": {\n        \"name\": \"array\"\n      },\n      \"required\": false,\n      \"description\": \"\"\n    },\n    \"width\": {\n      \"type\": {\n        \"name\": \"number\"\n      },\n      \"required\": false,\n      \"description\": \"\"\n    },\n    \"height\": {\n      \"type\": {\n        \"name\": \"number\"\n      },\n      \"required\": false,\n      \"description\": \"\"\n    }\n  }\n};\nexport default withStyles(styles, {\n  withTheme: true\n})(Image);\n\nvar _c;\n\n$RefreshReg$(_c, \"Image\");\n\nif (typeof STORYBOOK_REACT_CLASSES !== \"undefined\") {\n  STORYBOOK_REACT_CLASSES[\"src\\\\Image\\\\Image.js\"] = {\n    name: \"Image\",\n    docgenInfo: Image.__docgenInfo,\n    path: \"src\\\\Image\\\\Image.js\"\n  };\n}","map":{"version":3,"sources":["C:/Users/felip/OneDrive/Dokumente/cvc/core-master/src/Image/Image.js"],"names":["React","useContext","useState","BrandContext","withStyles","PropTypes","styles","Image","props","company","imageUrl","imageProcessorPath","mountSrcUrl","imgUrl","setImgUrl","fallbackPosition","setFallbackPosition","alt","className","onError","fallback","fallbackUrl","properties","src","width","height","newImgUrl","prevState","propTypes","string","isRequired","array","number","improveOriginalImage","scaleImage","path","pathSlices","unshift","join","step1","step2","steps","withTheme"],"mappings":"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","sourcesContent":["import React, { useContext, useState } from \"react\";\nimport { BrandContext } from \"../BrandContext/BrandContext\";\nimport { withStyles } from \"@material-ui/styles\";\nimport PropTypes from \"prop-types\";\nimport { styles } from \"./styles\";\n\nconst Image = props => {\n    // TODO rever implementação do contexto\n    var company = useContext(BrandContext);\n    const imageUrl = company ? `${company.imageProcessorPath}image/fetch` : \"\";\n    const [imgUrl, setImgUrl] = useState(mountSrcUrl(props, imageUrl));\n    const [fallbackPosition, setFallbackPosition] = useState(0);\n    const { alt, className } = props;\n\n    const onError = () => {\n        if (props.fallback || props.fallbackUrl) {\n            const properties = { src: props.fallbackUrl ? props.fallbackUrl : props.fallback[fallbackPosition], width: props.width, height: props.height };\n            const newImgUrl = mountSrcUrl(properties, imageUrl);\n            setImgUrl(newImgUrl);\n            props.fallback && setFallbackPosition(prevState => prevState + 1);\n        }\n    };\n\n    return (\n        <>\n            <img src={imgUrl} alt={alt} className={className} onError={onError} />\n        </>\n    );\n};\n\nImage.propTypes = {\n    className: PropTypes.string,\n    alt: PropTypes.string,\n    src: PropTypes.string.isRequired,\n    fallbackUrl: PropTypes.string,\n    fallback: PropTypes.array,\n    width: PropTypes.number,\n    height: PropTypes.number\n};\n\n/**\n * Mounts the url based on the component props\n * The sequence of efects matters! The effect is applyed to the output of the previous one\n */\nfunction mountSrcUrl({ src, width, height }, imageUrl) {\n    imageUrl = improveOriginalImage(imageUrl);\n    imageUrl = scaleImage(imageUrl, width, height);\n    return `${imageUrl}/${src}`;\n}\n\n/**\n * Width - adds width and Height dimensions\n */\nfunction scaleImage(path, width, height) {\n    const pathSlices = [\"c_fill\"];\n    if (width) pathSlices.unshift(`w_${width}`);\n    if (height) pathSlices.unshift(`h_${height}`);\n    return `${path}/${pathSlices.join(\",\")}`;\n}\n\n/**\n * Sharpen - Improves contrast without loosing quality\n */\nfunction improveOriginalImage(path) {\n    const step1 = [\"e_trim\"];\n    const step2 = [\"e_sharpen\", \"f_auto\", \"fl_lossy\"];\n    const steps = [step1.join(\",\"), step2.join(\",\")];\n    return `${path}/${steps.join(\"/\")}`;\n}\n\nexport default withStyles(styles, { withTheme: true })(Image);\n"]},"metadata":{},"sourceType":"module"}
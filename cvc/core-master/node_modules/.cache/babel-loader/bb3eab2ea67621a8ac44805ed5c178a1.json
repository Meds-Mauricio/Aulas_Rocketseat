{"ast":null,"code":"import _regeneratorRuntime from \"C:/Users/felip/OneDrive/Dokumente/cvc/core-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"C:/Users/felip/OneDrive/Dokumente/cvc/core-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"C:/Users/felip/OneDrive/Dokumente/cvc/core-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _jsxFileName = \"C:\\\\Users\\\\felip\\\\OneDrive\\\\Dokumente\\\\cvc\\\\core-master\\\\src\\\\UserContext\\\\index.tsx\",\n    _this = this,\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$();\n\nimport React, { createContext, useCallback, useContext, useEffect, useState } from \"react\";\nimport { Auth } from \"aws-amplify\";\nimport Cookies from \"universal-cookie\";\nimport useGa from \"../utils/useGa\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar UserDataContext = /*#__PURE__*/createContext({});\n\nvar UserDataProvider = function UserDataProvider(_ref) {\n  _s();\n\n  var config = _ref.config,\n      children = _ref.children;\n\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      isConfig = _useState2[0],\n      setisConfig = _useState2[1];\n\n  var _useState3 = useState(false),\n      _useState4 = _slicedToArray(_useState3, 2),\n      isUserAuth = _useState4[0],\n      setisUserAuth = _useState4[1];\n\n  var _useState5 = useState({}),\n      _useState6 = _slicedToArray(_useState5, 2),\n      currentUser = _useState6[0],\n      setCurrentUser = _useState6[1];\n\n  var _useState7 = useState(\"\"),\n      _useState8 = _slicedToArray(_useState7, 2),\n      userIdToken = _useState8[0],\n      setIdToken = _useState8[1];\n\n  var cookies = new Cookies();\n\n  var _useGa = useGa(),\n      saveOnGa = _useGa.saveOnGa;\n\n  useEffect(function () {\n    if (config) {\n      setIsConfig();\n    }\n  }, [config]);\n\n  var setIsConfig = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var _yield$Auth$currentAu, attributes;\n\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              _context.next = 3;\n              return Auth.currentAuthenticatedUser();\n\n            case 3:\n              setisUserAuth(true);\n              _context.next = 6;\n              return Auth.currentAuthenticatedUser();\n\n            case 6:\n              _yield$Auth$currentAu = _context.sent;\n              attributes = _yield$Auth$currentAu.attributes;\n              setCurrentUser(attributes);\n              _context.next = 14;\n              break;\n\n            case 11:\n              _context.prev = 11;\n              _context.t0 = _context[\"catch\"](0);\n              setisUserAuth(false);\n\n            case 14:\n              setisConfig(true);\n\n            case 15:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[0, 11]]);\n    }));\n\n    return function setIsConfig() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var setIsUserAuth = function setIsUserAuth(isAuth) {\n    setisUserAuth(isAuth);\n  };\n\n  var setUserIdToken = useCallback(function (idToken) {\n    setIdToken(idToken);\n  }, []);\n  var logout = useCallback( /*#__PURE__*/function () {\n    var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(_ref3) {\n      var noReload, willBeSavedInGA;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              noReload = _ref3.noReload, willBeSavedInGA = _ref3.willBeSavedInGA;\n              _context2.next = 3;\n              return Auth.signOut();\n\n            case 3:\n              setIsUserAuth(false);\n              cookies.remove(\"corpAgentId\", {\n                path: \"/\"\n              });\n              cookies.remove(\"agentId\", {\n                path: \"/\"\n              });\n              cookies.remove(\"branchId\", {\n                path: \"/\"\n              });\n              cookies.remove(\"access_token\", {\n                path: \"/\"\n              });\n\n              if (typeof window !== \"undefined\" && window.fingerprint) {\n                window.fingerprint.removeUserId();\n              }\n\n              localStorage.removeItem(\"user_email\");\n\n              if (willBeSavedInGA) {\n                saveOnGa({\n                  event: \"header_event\",\n                  category: \"Account\",\n                  action: \"Click on header options\",\n                  label: \"click on header item :: logout\"\n                });\n              }\n\n              if (!noReload) {\n                window.location.reload();\n              }\n\n            case 12:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    return function (_x) {\n      return _ref4.apply(this, arguments);\n    };\n  }(), [saveOnGa]);\n  return /*#__PURE__*/_jsxDEV(UserDataContext.Provider, {\n    value: {\n      currentUser: currentUser,\n      isUserAuth: isUserAuth,\n      setIsUserAuth: setIsUserAuth,\n      Auth: Auth,\n      isConfig: isConfig,\n      setIsConfig: setIsConfig,\n      setUserIdToken: setUserIdToken,\n      userIdToken: userIdToken,\n      logout: logout\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 111,\n    columnNumber: 9\n  }, _this);\n};\n\n_s(UserDataProvider, \"y2HlaUQJlrbPfsgUFn20EySCwJU=\", false, function () {\n  return [useGa];\n});\n\n_c = UserDataProvider;\n\nfunction useUserDataContext() {\n  _s2();\n\n  var context = useContext(UserDataContext);\n  return context;\n}\n\n_s2(useUserDataContext, \"b9L3QQ+jgeyIrH0NfHrJ8nn7VMU=\");\n\nexport { UserDataProvider, useUserDataContext };\n\nvar _c;\n\n$RefreshReg$(_c, \"UserDataProvider\");","map":{"version":3,"sources":["C:/Users/felip/OneDrive/Dokumente/cvc/core-master/src/UserContext/index.tsx"],"names":["React","createContext","useCallback","useContext","useEffect","useState","Auth","Cookies","useGa","UserDataContext","UserDataProvider","config","children","isConfig","setisConfig","isUserAuth","setisUserAuth","currentUser","setCurrentUser","userIdToken","setIdToken","cookies","saveOnGa","setIsConfig","currentAuthenticatedUser","attributes","setIsUserAuth","isAuth","setUserIdToken","idToken","logout","noReload","willBeSavedInGA","signOut","remove","path","window","fingerprint","removeUserId","localStorage","removeItem","event","category","action","label","location","reload","useUserDataContext","context"],"mappings":"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","sourcesContent":["import React, { createContext, ReactNode, useCallback, useContext, useEffect, useState } from \"react\";\nimport { Auth } from \"aws-amplify\";\nimport { AuthClass } from \"aws-amplify/dist/aws-amplify\"\nimport Cookies from \"universal-cookie\";\nimport useGa from \"../utils/useGa\";\n\ninterface ILogout {\n    noReload?: boolean\n    willBeSavedInGA?: boolean\n}\n\ninterface IUserDataContext {\n    currentUser: any\n    isUserAuth: boolean;\n    setIsUserAuth(isUserAuth): void;\n    Auth: AuthClass;\n    isConfig: boolean;\n    setIsConfig(): Promise<void>\n    setUserIdToken(idToken: string): void\n    userIdToken: string\n    logout(iLogout?: ILogout): Promise<void>\n}\n\ndeclare global {\n    interface Window {\n        fingerprint: any;\n    }\n}\n\ninterface IUserProvider {\n    config: any;\n    children: ReactNode;\n}\n\nconst UserDataContext = createContext<IUserDataContext>({} as IUserDataContext);\n\nconst UserDataProvider: React.FC<IUserProvider> = ({ config, children }: IUserProvider) => {\n    const [isConfig, setisConfig] = useState(false);\n    const [isUserAuth, setisUserAuth] = useState(false);\n    const [currentUser, setCurrentUser] = useState({});\n    const [userIdToken, setIdToken] = useState(\"\")\n\n    const cookies = new Cookies();\n    const { saveOnGa } = useGa();\n\n    useEffect(() => {\n        if (config) {\n            setIsConfig()\n        }\n    }, [config])\n\n    const setIsConfig = async () => {\n        try {\n            await Auth.currentAuthenticatedUser();\n            setisUserAuth(true);\n            const { attributes } = await Auth.currentAuthenticatedUser();\n            setCurrentUser(attributes);\n        } catch (error) {\n            setisUserAuth(false);\n        }\n        setisConfig(true);\n    }\n\n    const setIsUserAuth = (isAuth) => {\n        setisUserAuth(isAuth);\n\n    }\n\n    const setUserIdToken = useCallback((idToken: string) => {\n        setIdToken(idToken)\n    }, [])\n\n    const logout = useCallback(async ({noReload, willBeSavedInGA}: ILogout) => {\n        await Auth.signOut();\n        setIsUserAuth(false);\n\n        cookies.remove(\"corpAgentId\", {\n            path: \"/\"\n        });\n        cookies.remove(\"agentId\", {\n            path: \"/\"\n        });\n        cookies.remove(\"branchId\", {\n            path: \"/\"\n        });\n        cookies.remove(\"access_token\", {\n            path: \"/\"\n        });\n\n        if (typeof window !== \"undefined\" && window.fingerprint) {\n            window.fingerprint.removeUserId();\n        }\n\n        localStorage.removeItem(\"user_email\");\n\n        if(willBeSavedInGA) {\n            saveOnGa({\n                event: \"header_event\",\n                category: \"Account\",\n                action: \"Click on header options\",\n                label: \"click on header item :: logout\"\n            });\n        }\n        if(!noReload){\n            window.location.reload();\n        }\n\n    }, [saveOnGa])\n\n    return (\n        <UserDataContext.Provider value={{\n            currentUser,\n            isUserAuth,\n            setIsUserAuth,\n            Auth,\n            isConfig,\n            setIsConfig,\n            setUserIdToken,\n            userIdToken,\n            logout\n        }}>\n            {children}\n        </UserDataContext.Provider>\n    );\n};\n\nfunction useUserDataContext(): IUserDataContext {\n    const context = useContext(UserDataContext);\n    return context;\n}\n\nexport { UserDataProvider, useUserDataContext };\n"]},"metadata":{},"sourceType":"module"}